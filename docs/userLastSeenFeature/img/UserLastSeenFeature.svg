<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1319.4px" preserveAspectRatio="none" style="width:1179px;height:1319px;background:#FFFFFF;" version="1.1" viewBox="0 0 1179 1319" width="1179.9px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="1098.6012" style="stroke:#000000;stroke-width:1.35;" width="1155.72" x="9" y="131.3209"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="45.9" x2="45.9" y1="75.259" y2="1245.2221"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="126.9308" x2="126.9308" y1="75.259" y2="1245.2221"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="253.6752" x2="253.6752" y1="75.259" y2="1245.2221"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="386.3531" x2="386.3531" y1="75.259" y2="1245.2221"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="546.7983" x2="546.7983" y1="75.259" y2="1245.2221"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="774.145" x2="774.145" y1="75.259" y2="1245.2221"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="855.8587" x2="855.8587" y1="75.259" y2="1245.2221"/><line style="stroke:#181818;stroke-width:0.45;stroke-dasharray:5.0,5.0;" x1="996.6867" x2="996.6867" y1="75.259" y2="1245.2221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="50.4308" x="18" y="72.0967">Frontend</text><ellipse cx="45.9154" cy="12.15" fill="#E2E2F0" rx="7.2" ry="7.2" style="stroke:#181818;stroke-width:0.45;"/><path d="M45.9154,19.35 L45.9154,43.65 M34.2154,26.55 L57.6154,26.55 M45.9154,43.65 L34.2154,57.15 M45.9154,43.65 L57.6154,57.15 " fill="none" style="stroke:#181818;stroke-width:0.45;"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="50.4308" x="18" y="1257.9188">Frontend</text><ellipse cx="45.9154" cy="1268.7311" fill="#E2E2F0" rx="7.2" ry="7.2" style="stroke:#181818;stroke-width:0.45;"/><path d="M45.9154,1275.9311 L45.9154,1300.2311 M34.2154,1283.1311 L57.6154,1283.1311 M45.9154,1300.2311 L34.2154,1313.7311 M45.9154,1300.2311 L57.6154,1313.7311 " fill="none" style="stroke:#181818;stroke-width:0.45;"/><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="88.9444" x="82.8308" y="45"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="76.3444" x="89.1308" y="64.8967">DataManager</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="88.9444" x="82.8308" y="1244.3221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="76.3444" x="89.1308" y="1264.2188">DataManager</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="147.0779" x="180.7752" y="45"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="134.4779" x="187.0752" y="64.8967">AuthenticationController</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="147.0779" x="180.7752" y="1244.3221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="134.4779" x="187.0752" y="1264.2188">AuthenticationController</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="99.4403" x="336.8531" y="45"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="86.8403" x="343.1531" y="64.8967">EventController</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="99.4403" x="336.8531" y="1244.3221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="86.8403" x="343.1531" y="1264.2188">EventController</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="91.0362" x="501.7983" y="45"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="78.4362" x="508.0983" y="64.8967">OnlineService</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="91.0362" x="501.7983" y="1244.3221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="78.4362" x="508.0983" y="1264.2188">OnlineService</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="44.8137" x="752.545" y="45"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="32.2137" x="758.845" y="64.8967">Redis</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="44.8137" x="752.545" y="1244.3221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="32.2137" x="758.845" y="1264.2188">Redis</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="99.428" x="806.3587" y="45"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="86.828" x="812.6587" y="64.8967">UserRepository</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="99.428" x="806.3587" y="1244.3221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="86.828" x="812.6587" y="1264.2188">UserRepository</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="164.5875" x="914.7867" y="45"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="151.9875" x="921.0867" y="64.8967">ExpiredValueRedisListener</text><rect fill="#E2E2F0" height="29.359" rx="2.25" ry="2.25" style="stroke:#181818;stroke-width:0.45;" width="164.5875" x="914.7867" y="1244.3221"/><text fill="#000000" font-family="sans-serif" font-size="12.6" lengthAdjust="spacing" textLength="151.9875" x="921.0867" y="1264.2188">ExpiredValueRedisListener</text><rect fill="#EEEEEE" height="2.7" style="stroke:#EEEEEE;stroke-width:0.9;" width="1173.72" x="0" y="103.7399"/><line style="stroke:#000000;stroke-width:0.9;" x1="0" x2="1173.72" y1="103.7399" y2="103.7399"/><line style="stroke:#000000;stroke-width:0.9;" x1="0" x2="1173.72" y1="106.4399" y2="106.4399"/><rect fill="#EEEEEE" height="22.7619" style="stroke:#000000;stroke-width:1.8;" width="112.09" x="530.815" y="93.259"/><text fill="#000000" font-family="sans-serif" font-size="11.7" font-weight="bold" lengthAdjust="spacing" textLength="96.2394" x="536.215" y="109.4845">Last seen feature</text><path d="M9,131.3209 L63.1538,131.3209 L63.1538,139.6828 L54.1538,148.6828 L9,148.6828 L9,131.3209 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.35;"/><rect fill="none" height="1098.6012" style="stroke:#000000;stroke-width:1.35;" width="1155.72" x="9" y="131.3209"/><text fill="#000000" font-family="sans-serif" font-size="11.7" font-weight="bold" lengthAdjust="spacing" textLength="13.6538" x="22.5" y="144.8464">alt</text><text fill="#000000" font-family="sans-serif" font-size="9.9" font-weight="bold" lengthAdjust="spacing" textLength="112.7527" x="76.6538" y="143.804">[Flow when user logins]</text><polygon fill="#181818" points="243.5142,166.0447,252.5142,169.6447,243.5142,173.2447,247.1142,169.6447" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="45.9154" x2="248.9142" y1="169.6447" y2="169.6447"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="24.7197" x="52.2154" y="164.9083">login</text><polygon fill="#181818" points="845.2727,194.2066,854.2727,197.8066,845.2727,201.4066,848.8727,197.8066" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="254.3142" x2="850.6727" y1="197.8066" y2="197.8066"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="136.6066" x="260.6142" y="193.0702">update lastLoggedOn field</text><polygon fill="#181818" points="536.5165,222.3686,545.5165,225.9686,536.5165,229.5686,540.1165,225.9686" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="254.3142" x2="541.9165" y1="225.9686" y2="225.9686"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="185.8632" x="260.6142" y="221.2321">updateUserOnlineStatus to "Online"</text><polygon fill="#181818" points="764.1519,266.0924,773.1519,269.6924,764.1519,273.2924,767.7519,269.6924" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="769.5519" y1="269.6924" y2="269.6924"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="149.4435" x="553.6165" y="249.394">set key "user:{userId}:online"</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="75.4387" x="556.8671" y="264.956">with value true</text><polygon fill="#181818" points="264.2142,294.2543,255.2142,297.8543,264.2142,301.4543,260.6142,297.8543" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="258.8142" x2="546.4165" y1="297.8543" y2="297.8543"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="119.0109" x="269.6142" y="293.1179">return OnlineStatusDto</text><polygon fill="#181818" points="55.8154,340.6781,46.8154,344.2781,55.8154,347.8781,52.2154,344.2781" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="50.4154" x2="253.4142" y1="344.2781" y2="344.2781"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="171.6781" x="61.2154" y="339.5417">Notify all users that user is online</text><path d="M258.3,309.5543 L258.3,364.4543 L398.7,364.4543 L398.7,318.5543 L389.7,309.5543 L258.3,309.5543 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><path d="M389.7,309.5543 L389.7,318.5543 L398.7,318.5543 L389.7,309.5543 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="121.5989" x="263.7" y="326.6798">Notify subscribed users</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="113.8179" x="263.7" y="342.2417">send OnlineStatusDto</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="112.5154" x="263.7" y="357.8036">to /users/onlineStatus</text><line style="stroke:#000000;stroke-width:0.9;stroke-dasharray:2.0,2.0;" x1="9" x2="1164.72" y1="370.64" y2="370.64"/><text fill="#000000" font-family="sans-serif" font-size="9.9" font-weight="bold" lengthAdjust="spacing" textLength="116.5909" x="13.5" y="381.3231">[Flow when user log out]</text><polygon fill="#181818" points="243.5142,402.0697,252.5142,405.6697,243.5142,409.2697,247.1142,405.6697" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="45.9154" x2="248.9142" y1="405.6697" y2="405.6697"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="31.8779" x="52.2154" y="400.9333">logout</text><polygon fill="#181818" points="536.5165,430.2316,545.5165,433.8316,536.5165,437.4316,540.1165,433.8316" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="254.3142" x2="541.9165" y1="433.8316" y2="433.8316"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="185.8575" x="260.6142" y="429.0952">updateUserOnlineStatus to "Offline"</text><polygon fill="#181818" points="764.1519,458.3936,773.1519,461.9936,764.1519,465.5936,767.7519,461.9936" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="769.5519" y1="461.9936" y2="461.9936"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="165.7138" x="553.6165" y="457.2571">delete key "user:{userId}:online"</text><polygon fill="#181818" points="764.1519,502.1174,773.1519,505.7174,764.1519,509.3174,767.7519,505.7174" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="769.5519" y1="505.7174" y2="505.7174"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="202.7848" x="553.6165" y="485.419">update key "user:{userId}:lastSeenOn",</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="159.3154" x="556.8671" y="500.981">set current timestamp as value</text><polygon fill="#181818" points="264.2142,530.2793,255.2142,533.8793,264.2142,537.4793,260.6142,533.8793" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="258.8142" x2="546.4165" y1="533.8793" y2="533.8793"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="119.0109" x="269.6142" y="529.1429">return OnlineStatusDto</text><polygon fill="#181818" points="55.8154,576.7031,46.8154,580.3031,55.8154,583.9031,52.2154,580.3031" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="50.4154" x2="253.4142" y1="580.3031" y2="580.3031"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="171.6724" x="61.2154" y="575.5667">Notify all users that user is offline</text><path d="M258.3,545.5793 L258.3,600.4793 L398.7,600.4793 L398.7,554.5793 L389.7,545.5793 L258.3,545.5793 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><path d="M389.7,545.5793 L389.7,554.5793 L398.7,554.5793 L389.7,545.5793 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="121.5989" x="263.7" y="562.7048">Notify subscribed users</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="113.8179" x="263.7" y="578.2667">send OnlineStatusDto</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="112.5154" x="263.7" y="593.8286">to /users/onlineStatus</text><line style="stroke:#000000;stroke-width:0.9;stroke-dasharray:2.0,2.0;" x1="9" x2="1164.72" y1="606.665" y2="606.665"/><text fill="#000000" font-family="sans-serif" font-size="9.9" font-weight="bold" lengthAdjust="spacing" textLength="145.764" x="13.5" y="617.3481">[Flow when application restart]</text><polygon fill="#181818" points="845.2727,638.0947,854.2727,641.6947,845.2727,645.2947,848.8727,641.6947" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="127.303" x2="850.6727" y1="641.6947" y2="641.6947"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="138.5319" x="133.603" y="636.9583">get all users last login data</text><polygon fill="#181818" points="137.203,666.2566,128.203,669.8566,137.203,673.4566,133.603,669.8566" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="131.803" x2="855.1727" y1="669.8566" y2="669.8566"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="186.6573" x="142.603" y="665.1202">return Map&lt;Long, ZonedDateTime&gt;</text><polygon fill="#181818" points="764.1519,725.5424,773.1519,729.1424,764.1519,732.7424,767.7519,729.1424" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="127.303" x2="769.5519" y1="729.1424" y2="729.1424"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="141.1255" x="133.603" y="693.2821">set all users last login data,</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="188.4568" x="136.8536" y="708.844">set keys "user:{userId}:lastSeenOn",</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="159.3154" x="136.8536" y="724.406">set current timestamp as value</text><line style="stroke:#000000;stroke-width:0.9;stroke-dasharray:2.0,2.0;" x1="9" x2="1164.72" y1="737.2424" y2="737.2424"/><text fill="#000000" font-family="sans-serif" font-size="9.9" font-weight="bold" lengthAdjust="spacing" textLength="156.7613" x="13.5" y="747.9255">[Flow when frontend sends event</text><text fill="#000000" font-family="sans-serif" font-size="9.9" font-weight="bold" lengthAdjust="spacing" textLength="169.4118" x="16.2505" y="761.0933">update user online status to Offline]</text><polygon fill="#181818" points="375.7733,781.8398,384.7733,785.4398,375.7733,789.0398,379.3733,785.4398" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="45.9154" x2="381.1733" y1="785.4398" y2="785.4398"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="70.8741" x="52.2154" y="780.7034">User is offline</text><polygon fill="#181818" points="536.5165,810.0018,545.5165,813.6018,536.5165,817.2018,540.1165,813.6018" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="386.5733" x2="541.9165" y1="813.6018" y2="813.6018"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="127.4774" x="392.8733" y="808.8653">updateUserOnlineStatus</text><polygon fill="#181818" points="764.1519,838.1637,773.1519,841.7637,764.1519,845.3637,767.7519,841.7637" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="769.5519" y1="841.7637" y2="841.7637"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="165.7138" x="553.6165" y="837.0272">delete key "user:{userId}:online"</text><polygon fill="#181818" points="764.1519,881.8875,773.1519,885.4875,764.1519,889.0875,767.7519,885.4875" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="769.5519" y1="885.4875" y2="885.4875"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="202.7848" x="553.6165" y="865.1892">update key "user:{userId}:lastSeenOn",</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="159.3154" x="556.8671" y="880.7511">set current timestamp as value</text><path d="M779.4,858.5446 L779.4,882.8446 L885.6,882.8446 L885.6,867.5446 L876.6,858.5446 L779.4,858.5446 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><path d="M876.6,858.5446 L876.6,867.5446 L885.6,867.5446 L876.6,858.5446 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="87.7957" x="784.8" y="875.6701">Update it in redis</text><polygon fill="#181818" points="396.4733,925.6113,387.4733,929.2113,396.4733,932.8113,392.8733,929.2113" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="391.0733" x2="546.4165" y1="929.2113" y2="929.2113"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="119.0109" x="401.8733" y="908.913">return OnlineStatusDt0</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="135.8925" x="405.1239" y="924.4749">(with last seen timestamp)</text><polygon fill="#181818" points="55.8154,972.0352,46.8154,975.6352,55.8154,979.2352,52.2154,975.6352" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="50.4154" x2="385.6733" y1="975.6352" y2="975.6352"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="171.6724" x="61.2154" y="970.8987">Notify all users that user is offline</text><path d="M390.6,940.9113 L390.6,995.8113 L531,995.8113 L531,949.9113 L522,940.9113 L390.6,940.9113 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><path d="M522,940.9113 L522,949.9113 L531,949.9113 L522,940.9113 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="121.5989" x="396" y="958.0368">Notify subscribed users</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="113.8179" x="396" y="973.5987">send OnlineStatusDto</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="112.5154" x="396" y="989.1606">to /users/onlineStatus</text><line style="stroke:#000000;stroke-width:0.9;stroke-dasharray:2.0,2.0;" x1="9" x2="1164.72" y1="1001.9971" y2="1001.9971"/><text fill="#000000" font-family="sans-serif" font-size="9.9" font-weight="bold" lengthAdjust="spacing" textLength="227.2021" x="13.5" y="1012.6802">[Flow when online status key in redis is expired]</text><polygon fill="#181818" points="557.2165,1043.9077,548.2165,1047.5077,557.2165,1051.1077,553.6165,1047.5077" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="551.8165" x2="996.1805" y1="1047.5077" y2="1047.5077"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="127.4774" x="562.6165" y="1042.7713">updateUserOnlineStatus</text><path d="M1000.8,1020.5648 L1000.8,1060.1648 L1150.2,1060.1648 L1150.2,1029.5648 L1141.2,1020.5648 L1000.8,1020.5648 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><path d="M1141.2,1020.5648 L1141.2,1029.5648 L1150.2,1029.5648 L1141.2,1020.5648 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="90.3951" x="1006.2" y="1037.6903">when key expires</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="130.7395" x="1006.2" y="1053.2522">update user online status</text><polygon fill="#181818" points="764.1519,1082.5506,773.1519,1086.1506,764.1519,1089.7506,767.7519,1086.1506" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="769.5519" y1="1086.1506" y2="1086.1506"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="165.7138" x="553.6165" y="1081.4142">delete key "user:{userId}:online"</text><polygon fill="#181818" points="764.1519,1126.2744,773.1519,1129.8744,764.1519,1133.4744,767.7519,1129.8744" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="769.5519" y1="1129.8744" y2="1129.8744"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="202.7848" x="553.6165" y="1109.5761">update key "user:{userId}:lastSeenOn",</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="159.3154" x="556.8671" y="1125.138">set current timestamp as value</text><polygon fill="#181818" points="986.2805,1154.4363,995.2805,1158.0363,986.2805,1161.6363,989.8805,1158.0363" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="547.3165" x2="991.6805" y1="1158.0363" y2="1158.0363"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="119.0109" x="553.6165" y="1153.2999">return OnlineStatusDto</text><polygon fill="#181818" points="55.8154,1200.8602,46.8154,1204.4602,55.8154,1208.0602,52.2154,1204.4602" style="stroke:#181818;stroke-width:0.9;"/><line style="stroke:#181818;stroke-width:0.9;" x1="50.4154" x2="996.1805" y1="1204.4602" y2="1204.4602"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="171.6724" x="61.2154" y="1199.7237">Notify all users that user is offline</text><path d="M1000.8,1169.7363 L1000.8,1224.6363 L1141.2,1224.6363 L1141.2,1178.7363 L1132.2,1169.7363 L1000.8,1169.7363 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><path d="M1132.2,1169.7363 L1132.2,1178.7363 L1141.2,1178.7363 L1132.2,1169.7363 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.45;"/><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="121.5989" x="1006.2" y="1186.8618">Notify subscribed users</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="113.8179" x="1006.2" y="1202.4237">send OnlineStatusDto</text><text fill="#000000" font-family="sans-serif" font-size="11.7" lengthAdjust="spacing" textLength="112.5154" x="1006.2" y="1217.9856">to /users/onlineStatus</text><!--SRC=[rLVVQzim47xtNt7aQOECxjaiXR6kK4WNQ9SzZBseySKHKoKZdPE5iVzz9yb9RSzAcctGrWy1I_VTZ- - -anon86FXqXfDg8ki4fRaGbP24rm84jT2Yn9jP_rzJIlK_2f86ls1aTOerJFwk6QJnDvCAwdn5krQBh2pSuE5T9sLkKDxWvLnalFSTaFygAJ5uejGDGRWL3ekWeDbambCXIDmY1gMAAYs29D9bWb5SAdC1ZPS0jJi79GffNOPyBEZ0TwS9wk4F28286d43hgPCwok2a48YXERchB4OiQvILJ5KLSTmlQUV81cXxX21sHW51T6mMKNndu2IuntIF0Tjp3o1EG__UzLyIit4GlVD6mahM3jcGMoDGwxEq0HM6JEDRJpko2J7Irrtu8SFXcIooq8fKAZkBwLeDWphY8c6_nfmxHQMQuel3PF0tVrdLjOUOT5zD8sSJvGFyNMFXDw5a1dfcKKB3pInyqoL0u7D0McfXD5jKFyBoaibu_GGe4AcRwq70x36r4FmBtERtd-PdeqzfBoeblKrd9bGF8U7Odx2eIBCdkE2elyFJ-9YQfIJMdC0lDeOrQj0tlm02gv0m-r-lx4emouXI9uw47OITjdlkFyMbJlfaQNO_XgD1PiWv-ve-T3MRJFd6JmSQCFbf7xHntroLhkskqxuG3zlUJTDC8DpOxKWzlFpgpL-lRyzcurBci-89Q-rQF7zkLCwi0ypAD_II2zBFr5tbNnO7P_CZeurszzNg_2hQJs5_i-jzSfsbkpViAmFysu7nZuhZvz1tSK-zGnVWT53bBVH2UAi4T0oCB7ZR6YJNA2kdr_4PfEY3F9PfwwVeusuQ-kdq597f7Z8IaUbE53w_m_Wjy0]--></g></svg>